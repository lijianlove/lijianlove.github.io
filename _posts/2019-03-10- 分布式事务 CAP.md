---
layout:     post
title:      分布式事务 CAP
subtitle:   CAP
date:       2019-03-10
author:     lijian
header-img: img/post-bg-hacker.jpg
catalog: true
tags:
    - 事务
---

#### 简介
CAP 定理，又称布鲁尔定理。C、A、P 不可能同时达到，这就是CAP理论

* C: Consistency 一致性

  "all nodes see the same data at the same time" 即所有数据节点在同一时刻的数据完全一致的。

* A: Availability 可用性

  系统提供的服务必须处于可用状态。只要是接收到请求，就必须给用户返回响应。

* P: Partition tolerance 分区容错性

  分布式系统遇到网络分区错误的时候，系统仍然可以正常提供服务

#### 再理解

CA,CP,AP,CAP。分区容错必须保证，否则就不是分布式系统了。也就是我们可选 AP,CP,CAP。CAP理论告诉我们，CA无法同时满足，我们可选AP,CP。

如果满足一致性，数据写入node1 必须要写入node2,这个时候就要对node2 的状态进行锁定来同步写，node2 的用户必须等待，这就不满足了可用性。
同理如果满足可用性，必须牺牲一致性。


对于数据严格要求一致的，我们必须CP,即使是要报错都必须满足。

对于可容忍的，我们可以AP,采用后续补偿方式满足C。

三取二，不是放弃第三点，而是为第三点做一些防备措施或者冗余方案。